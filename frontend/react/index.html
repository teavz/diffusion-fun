<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Diffusion Fun — Gallery</title>
    <style>
      :root { color-scheme: light dark; }
      body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
      header { position: sticky; top: 0; background: rgba(255,255,255,0.8); backdrop-filter: blur(6px); border-bottom: 1px solid #ddd; padding: 12px 16px; z-index: 10; }
      main { padding: 16px; display: grid; gap: 28px; }
      h1 { margin: 0; font-size: 20px; }
      .section { display: grid; gap: 12px; }
      .section h2 { margin: 0; font-size: 18px; border-left: 4px solid #6b6bff; padding-left: 8px; }
      .row { display: grid; grid-auto-flow: column; grid-auto-columns: minmax(120px, 1fr); gap: 8px; overflow-x: auto; padding-bottom: 6px; }
      figure { margin: 0; display: grid; gap: 6px; }
      img { width: 100%; height: auto; border-radius: 6px; border: 1px solid #ddd; background: #fafafa; }
      figcaption { font-size: 12px; color: #555; text-align: center; }
      /* Small screens: make columns narrower */
      @media (max-width: 640px) {
        .row { grid-auto-columns: minmax(90px, 1fr); }
      }
    </style>
    <!-- React (UMD) + Babel for quick, no-build JSX -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  </head>
  <body>
    <header>
      <h1>Diffusion Fun — Gallery</h1>
    </header>
    <main id="root"></main>

    <script type="text/babel">
      const base = "../../notebook_outputs/manifest.json/images";

      const Section = ({ title, rows }) => (
        <section className="section">
          <h2>{title}</h2>
          {rows.map((row, idx) => (
            <div className="row" key={idx} aria-label={`${title} row ${idx+1}`}>
              {row.map(item => (
                <figure key={item.label || item.src}>
                  <img loading="lazy" src={`${base}/${item.src}`} alt={item.label || title} />
                  {item.label ? <figcaption>{item.label}</figcaption> : null}
                </figure>
              ))}
            </div>
          ))}
        </section>
      );

      // Helpers to shape rows
      const simpleRow = (dir, names, withLabels=false) =>
        [names.map(n => ({ src: `${dir}/${n}.png`, label: withLabels ? n : undefined }))];

      const numberedRow = (dir, stem, count, withLabels=false) =>
        [Array.from({ length: count }, (_, i) => {
          const label = `${stem}${i+1}`;
          return { src: `${dir}/${label}.png`, label: withLabels ? label : undefined };
        })];

      const multiRows = (dir, stems, counts, withLabels=false) =>
        stems.map((stem, idx) => Array.from({ length: counts[idx] }, (_, i) => {
          const label = `${stem}${i+1}`;
          return { src: `${dir}/${label}.png`, label: withLabels ? label : undefined };
        }));

      const App = () => {
        const sections = [
          {
            title: "1.0 — model samples",
            rows: simpleRow("1.0", ["manhat", "rocketship", "snowyvillage"], false),
          },
          {
            title: "1.3 — one step denoising",
            rows: [
              ["t250a","t250b","t250c"].map(n => ({ src: `1.3/${n}.png`, label: n })),
              ["t500a","t500b","t500c"].map(n => ({ src: `1.3/${n}.png`, label: n })),
              ["t750a","t750b","t750c"].map(n => ({ src: `1.3/${n}.png`, label: n })),
            ],
          },
          {
            title: "1.4 — iterative denoising",
            rows: [
              ["a","b","c","d","e","f","blur"].map(n => ({ src: `1.4/${n}.png` })),
            ],
          },
          {
            title: "1.5 — diffusion model sampling",
            rows: simpleRow("1.5", ["a","b","c","d","e"], false),
          },
          {
            title: "1.6 — classifier free guidance",
            rows: simpleRow("1.6", ["a","b","c","d","e"], false),
          },
          {
            title: "1.7 — image-to-image translation",
            rows: multiRows("1.7", ["amalfi", "barista", "high"], [6,6,6], true),
          },
          {
            title: "1.7.1 — hand-drawn and web images",
            rows: multiRows("1.7.1", ["avo", "lizard"], [6,6], true),
          },
          {
            title: "1.7.2 — mask",
            rows: numberedRow("1.7.2", "mask", 6, false),
          },
          {
            title: "1.7.3 — text conditioned image to image",
            rows: multiRows("1.7.3", ["man", "pencil", "rocket"], [6,6,6], true),
          },
          {
            title: "1.8 — visual anagrams",
            rows: numberedRow("1.8", "manfire", 7, false),
          },
          {
            title: "1.10 — hybrid images",
            rows: numberedRow("1.10", "waterskull", 7, false),
          },
        ];

        return (
          <div>
            {sections.map(({ title, rows }) => (
              <Section key={title} title={title} rows={rows} />
            ))}
          </div>
        );
      };

      ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
  </body>
  </html>
